!function(t,e,a,i){"use strict";a.defineProperty(t,"__esModule",{value:!0});var n=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t};function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),a.defineProperty(t,r.key,r)}}var o,s,u=e("../../npm/@tarojs/taro-weapp/index.js"),c=f(u),p=f(e("../../npm/classnames/index.js"));function f(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var m=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=a.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(a.setPrototypeOf?a.setPrototypeOf(t,e):t.__proto__=e)}(d,u.Component),n(d,[{key:"_constructor",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var o=a.getOwnPropertyDescriptor(e,n);if(void 0===o){var s=a.getPrototypeOf(e);return null===s?void 0:t(s,n,r)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(r):void 0})(d.prototype.__proto__||a.getPrototypeOf(d.prototype),"_constructor",this).apply(this,arguments),this.state={running:!1,ticksNumber:""},this.$$refs=new c.default.RefsArray}},{key:"componentDidMount",value:function(){var t=this.props,e=t.sendTxt,n=t.autoStart;this.ticksTimer&&clearTimeout(this.ticksTimer),n?this.handleStart():this.setState({ticksNumber:e})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.ticksTimer)}},{key:"_createData",value:function(t,e,n){this.__state=t||this.state||{},this.__props=e||this.props||{},this.$prefix;var r=this.__state,o=r.running,s=(r.ticksNumber,(0,p.default)("v-otp","v-class",{"v-optlite-running":o}));return a.assign(this.__state,{anonymousState__temp:s}),this.__state}}]),s=o=d,o.$$events=["handleStart"],o.$$componentPath="_components/otp/index",s);function d(){var t,e,s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var n=arguments.length,r=i(n),o=0;o<n;o++)r[o]=arguments[o];return(e=s=l(this,(t=d.__proto__||a.getPrototypeOf(d)).call.apply(t,[this].concat(r)))).$usedState=["anonymousState__temp","ticksNumber","running","sendTxt","autoStart","beforeSendRequest","processingTxt","totalTicks","duration","sentTxt","format"],s.handleStart=function(){var t=s.props,e=t.beforeSendRequest,n=t.processingTxt,r=(t.onSendRequest,t.sendTxt),o=t.totalTicks;if(e()&&!s.state.running){s.setState({ticksNumber:n,running:!0});try{s.props.onSendRequest().then(function(){s._startTicker(o)})}catch(t){s.setState({ticksNumber:r,running:!1})}}},s._startTicker=function(t){var e=s.props,n=e.duration,r=e.sentTxt;s.setState({ticksNumber:s._formatMessage(t),running:!0}),s.ticksTimer=setTimeout(function(){1<t?s._startTicker(t-1):s.setState({ticksNumber:r,running:!1})},n)},s._formatMessage=function(t){var e=s.props.format;return(void 0===e?"":e).replace("{t}",t)},s.customComponents=[],l(s,e)}m.defaultProps={totalTicks:60,duration:1e3,autoStart:!1,format:"{t}s后可重发",sendTxt:"获取验证码",sentTxt:"重新获取",processingTxt:"发送中...",beforeSendRequest:function(){return!0},onSendRequest:function(){}},m.externalClasses=["v-class"],t.default=m,Component(e("../../npm/@tarojs/taro-weapp/index.js").default.createComponent(m))}(exports,require,Object,Array);