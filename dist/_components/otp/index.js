"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _class,_temp2,_createClass=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}(),_get=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,n,r)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(r):void 0},_index=require("../../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index),_index3=require("../../npm/classnames/index.js"),_index4=_interopRequireDefault(_index3);function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Otp=(_temp2=_class=function(){function i(){var t,e,s;_classCallCheck(this,i);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=s=_possibleConstructorReturn(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(r)))).$usedState=["anonymousState__temp","ticksNumber","running","sendTxt","autoStart","beforeSendRequest","processingTxt","totalTicks","duration","sentTxt","format"],s.handleStart=function(){var t=s.props,e=t.beforeSendRequest,n=t.processingTxt,r=(t.onSendRequest,t.sendTxt),o=t.totalTicks;if(e()&&!s.state.running){s.setState({ticksNumber:n,running:!0});try{s.props.onSendRequest().then(function(){s._startTicker(o)})}catch(t){s.setState({ticksNumber:r,running:!1})}}},s._startTicker=function(t){var e=s.props,n=e.duration,r=e.sentTxt;s.setState({ticksNumber:s._formatMessage(t),running:!0}),s.ticksTimer=setTimeout(function(){1<t?s._startTicker(t-1):s.setState({ticksNumber:r,running:!1})},n)},s._formatMessage=function(t){var e=s.props.format;return(void 0===e?"":e).replace("{t}",t)},s.customComponents=[],_possibleConstructorReturn(s,e)}return _inherits(i,_index.Component),_createClass(i,[{key:"_constructor",value:function(){_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"_constructor",this).apply(this,arguments),this.state={running:!1,ticksNumber:""},this.$$refs=[]}},{key:"componentDidMount",value:function(){var t=this.props,e=t.sendTxt,n=t.autoStart;this.ticksTimer&&clearTimeout(this.ticksTimer),n?this.handleStart():this.setState({ticksNumber:e})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.ticksTimer)}},{key:"_createData",value:function(t,e,n){this.__state=t||this.state||{},this.__props=e||this.props||{};this.$prefix;var r=this.__state,o=r.running,s=(r.ticksNumber,(0,_index4.default)("v-otp","v-class",{"v-optlite-running":o}));return Object.assign(this.__state,{anonymousState__temp:s}),this.__state}}]),i}(),_class.$$events=["handleStart"],_class.$$componentPath="_components/otp/index",_temp2);Otp.defaultProps={totalTicks:60,duration:1e3,autoStart:!1,format:"{t}s后可重发",sendTxt:"获取验证码",sentTxt:"重新获取",processingTxt:"发送中...",beforeSendRequest:function(){return!0},onSendRequest:function(){}},Otp.externalClasses=["v-class"],exports.default=Otp,Component(require("../../npm/@tarojs/taro-weapp/index.js").default.createComponent(Otp));